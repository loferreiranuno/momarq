# Development overrides
services:
  postgres:
    ports:
      - "5432:5432"  # Expose for local tooling (pgAdmin, DBeaver, etc.)

  api:
    build:
      context: ./src/backend
      dockerfile: VisualSearch.Api/Dockerfile
    environment:
      - ASPNETCORE_ENVIRONMENT=Development
      - ConnectionStrings__DefaultConnection=Host=postgres;Database=visualsearch;Username=vsuser;Password=vspassword123
    ports:
      - "5000:8080"  # Direct API access for debugging
    # volumes:
    #   - ./src/backend/VisualSearch.Api:/app:ro  # Hot reload (requires rebuild)

  nginx:
    ports:
      - "80:80"
    # For dev live-reload with `vite dev`, proxy directly to Vite instead of mounting raw sources over the built assets.
    # If you really need to mount, point to a built `dist/` folder, not `src/`, to avoid MIME/type issues.
